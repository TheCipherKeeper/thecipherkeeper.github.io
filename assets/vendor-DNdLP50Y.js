const J=(e,t)=>e===t,M=Symbol("solid-proxy"),Z=typeof Proxy=="function",ee=Symbol("solid-track"),U={equals:J};let B=W;const v=1,D=2,G={owned:null,cleanups:null,context:null,owner:null};var f=null;let L=null,te=null,c=null,a=null,m=null,I=0;function F(e,t){const r=c,n=f,s=e.length===0,l=t===void 0?n:t,i=s?G:{owned:null,cleanups:null,context:l?l.context:null,owner:l},o=s?e:()=>e(()=>O(()=>E(i)));f=i,c=null;try{return P(o,!0)}finally{c=r,f=n}}function ne(e,t){t=t?Object.assign({},U,t):U;const r={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},n=s=>(typeof s=="function"&&(s=s(r.value)),V(r,s));return[Q.bind(r),n]}function he(e,t,r){const n=$(e,t,!1,v);k(n)}function re(e,t,r){B=ie;const n=$(e,t,!1,v);n.user=!0,m?m.push(n):k(n)}function K(e,t,r){r=r?Object.assign({},U,r):U;const n=$(e,t,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,k(n),Q.bind(n)}function O(e){if(c===null)return e();const t=c;c=null;try{return e()}finally{c=t}}function we(e){re(()=>O(e))}function se(e){return f===null||(f.cleanups===null?f.cleanups=[e]:f.cleanups.push(e)),e}function pe(){return f}function Q(){if(this.sources&&this.state)if(this.state===v)k(this);else{const e=a;a=null,P(()=>T(this),!1),a=e}if(c){const e=this.observers?this.observers.length:0;c.sources?(c.sources.push(this),c.sourceSlots.push(e)):(c.sources=[this],c.sourceSlots=[e]),this.observers?(this.observers.push(c),this.observerSlots.push(c.sources.length-1)):(this.observers=[c],this.observerSlots=[c.sources.length-1])}return this.value}function V(e,t,r){let n=e.value;return(!e.comparator||!e.comparator(n,t))&&(e.value=t,e.observers&&e.observers.length&&P(()=>{for(let s=0;s<e.observers.length;s+=1){const l=e.observers[s],i=L&&L.running;i&&L.disposed.has(l),(i?!l.tState:!l.state)&&(l.pure?a.push(l):m.push(l),l.observers&&_(l)),i||(l.state=v)}if(a.length>1e6)throw a=[],new Error},!1)),t}function k(e){if(!e.fn)return;E(e);const t=I;le(e,e.value,t)}function le(e,t,r){let n;const s=f,l=c;c=f=e;try{n=e.fn(t)}catch(i){return e.pure&&(e.state=v,e.owned&&e.owned.forEach(E),e.owned=null),e.updatedAt=r+1,z(i)}finally{c=l,f=s}(!e.updatedAt||e.updatedAt<=r)&&(e.updatedAt!=null&&"observers"in e?V(e,n):e.value=n,e.updatedAt=r)}function $(e,t,r,n=v,s){const l={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:f,context:f?f.context:null,pure:r};return f===null||f!==G&&(f.owned?f.owned.push(l):f.owned=[l]),l}function R(e){if(e.state===0)return;if(e.state===D)return T(e);if(e.suspense&&O(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<I);)e.state&&t.push(e);for(let r=t.length-1;r>=0;r--)if(e=t[r],e.state===v)k(e);else if(e.state===D){const n=a;a=null,P(()=>T(e,t[0]),!1),a=n}}function P(e,t){if(a)return e();let r=!1;t||(a=[]),m?r=!0:m=[],I++;try{const n=e();return ue(r),n}catch(n){r||(m=null),a=null,z(n)}}function ue(e){if(a&&(W(a),a=null),e)return;const t=m;m=null,t.length&&P(()=>B(t),!1)}function W(e){for(let t=0;t<e.length;t++)R(e[t])}function ie(e){let t,r=0;for(t=0;t<e.length;t++){const n=e[t];n.user?e[r++]=n:R(n)}for(t=0;t<r;t++)R(e[t])}function T(e,t){e.state=0;for(let r=0;r<e.sources.length;r+=1){const n=e.sources[r];if(n.sources){const s=n.state;s===v?n!==t&&(!n.updatedAt||n.updatedAt<I)&&R(n):s===D&&T(n,t)}}}function _(e){for(let t=0;t<e.observers.length;t+=1){const r=e.observers[t];r.state||(r.state=D,r.pure?a.push(r):m.push(r),r.observers&&_(r))}}function E(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),n=e.sourceSlots.pop(),s=r.observers;if(s&&s.length){const l=s.pop(),i=r.observerSlots.pop();n<s.length&&(l.sourceSlots[i]=n,s[n]=l,r.observerSlots[n]=i)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)E(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)E(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function oe(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function z(e,t=f){throw oe(e)}const ce=Symbol("fallback");function Y(e){for(let t=0;t<e.length;t++)e[t]()}function fe(e,t,r={}){let n=[],s=[],l=[],i=0,o=t.length>1?[]:null;return se(()=>Y(l)),()=>{let h=e()||[],w=h.length,p,u;return h[ee],O(()=>{let S,x,y,j,C,b,g,d,A;if(w===0)i!==0&&(Y(l),l=[],n=[],s=[],i=0,o&&(o=[])),r.fallback&&(n=[ce],s[0]=F(H=>(l[0]=H,r.fallback())),i=1);else if(i===0){for(s=new Array(w),u=0;u<w;u++)n[u]=h[u],s[u]=F(X);i=w}else{for(y=new Array(w),j=new Array(w),o&&(C=new Array(w)),b=0,g=Math.min(i,w);b<g&&n[b]===h[b];b++);for(g=i-1,d=w-1;g>=b&&d>=b&&n[g]===h[d];g--,d--)y[d]=s[g],j[d]=l[g],o&&(C[d]=o[g]);for(S=new Map,x=new Array(d+1),u=d;u>=b;u--)A=h[u],p=S.get(A),x[u]=p===void 0?-1:p,S.set(A,u);for(p=b;p<=g;p++)A=n[p],u=S.get(A),u!==void 0&&u!==-1?(y[u]=s[p],j[u]=l[p],o&&(C[u]=o[p]),u=x[u],S.set(A,u)):l[p]();for(u=b;u<w;u++)u in y?(s[u]=y[u],l[u]=j[u],o&&(o[u]=C[u],o[u](u))):s[u]=F(X);s=s.slice(0,i=w),n=h.slice(0)}return s});function X(S){if(l[u]=S,o){const[x,y]=ne(u);return o[u]=y,t(h[u],x)}return t(h[u])}}}function be(e,t){return O(()=>e(t||{}))}function N(){return!0}const q={get(e,t,r){return t===M?r:e.get(t)},has(e,t){return t===M?!0:e.has(t)},set:N,deleteProperty:N,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:N,deleteProperty:N}},ownKeys(e){return e.keys()}};function ge(e,...t){if(Z&&M in e){const s=new Set(t.length>1?t.flat():t[0]),l=t.map(i=>new Proxy({get(o){return i.includes(o)?e[o]:void 0},has(o){return i.includes(o)&&o in e},keys(){return i.filter(o=>o in e)}},q));return l.push(new Proxy({get(i){return s.has(i)?void 0:e[i]},has(i){return s.has(i)?!1:i in e},keys(){return Object.keys(e).filter(i=>!s.has(i))}},q)),l}const r={},n=t.map(()=>({}));for(const s of Object.getOwnPropertyNames(e)){const l=Object.getOwnPropertyDescriptor(e,s),i=!l.get&&!l.set&&l.enumerable&&l.writable&&l.configurable;let o=!1,h=0;for(const w of t)w.includes(s)&&(o=!0,i?n[h][s]=l.value:Object.defineProperty(n[h],s,l)),++h;o||(i?r[s]=l.value:Object.defineProperty(r,s,l))}return[...n,r]}const ae=e=>`Stale read from <${e}>.`;function de(e){const t="fallback"in e&&{fallback:()=>e.fallback};return K(fe(()=>e.each,e.children,t||void 0))}function me(e){const t=e.keyed,r=K(()=>e.when,void 0,{equals:(n,s)=>t?n===s:!n==!s});return K(()=>{const n=r();if(n){const s=e.children;return typeof s=="function"&&s.length>0?O(()=>s(t?n:()=>{if(!O(r))throw ae("Show");return e.when})):s}return e.fallback},void 0,void 0)}export{de as F,me as S,he as a,K as b,F as c,be as d,ne as e,re as f,pe as g,we as o,ge as s,O as u};
